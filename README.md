# opencv-photoshop
用OpenCV实现phtoto的抠图功能。欢迎关注我的哔哩哔哩频道：向日葵骑士 Opencv-photoshp awesome



</font>

@[TOC](文章目录)


<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

# 前言
如何使用C++和Opencv实现Photoshop的抠图功能呢？相信初学者一定对这个需求一筹莫展吧。今天跟大家分享一下我的图像处理课设作业--Photoshop抠图功能 。

<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">
<font color=#999AAA >提示：以下是本篇文章正文内容，下面案例可供参考。
# 一、基本介绍
抠图的实现本质上属于图像分割过程，传统的图像分割算法有基于灰度值不连续性质的分割、基于图像边缘分割、基于图像阈值分割和基于区域分割等。我们主要利用分水岭算法来实现课程设计的核心功能——抠图，并将分水岭算法封装为独立的函数和文件，使得代码更加模块化，方便使用者的阅读和调用。对于鼠标按键和GUI中的事件的处理，我们在函数中采用了轮询机制处理，简介直观。

# 二、功能介绍
于GUI界面的设计，我们经过斟酌后选择采用QT结合C++实现，在用户交互界面上可以通过鼠标和键盘的操作完成抠图整体过程。
对功能的具体描述和简介如下：
## ①鼠标绘制前置标记：
分水岭算法要求在处理图像前获取用户设置的前置标记信息，我们采用了通过鼠标在图像上绘制白色轮廓的方法来向图像传递轮廓，从而开始真正的图像分割过程。
## ②自由调节画笔的大小：
由于对图像进行前置标记时会出现不同位置需要用到不同粗细的白色轮廓，因此我们通过GUI界面上的滑动条实现了自由调整画笔大小的功能。
## ③设置橡皮擦：
考虑到用户进行前置标记时的失误情况，我们创新地实现了橡皮擦功能，采用非标记像素的圆形填充在蒙版图像中的方式，直接进行蒙版的修改，通过黑色的填充显示出了橡皮擦的效果。同样的，我们也通过GUI界面上的滑动条实现了自由调整橡皮擦大小的功能，但出于橡皮擦尺寸太大将导致程序卡死的原因，我们为调整尺度设置了上下限，提高程序的鲁棒性。同时也增加了部分步骤改善显示效果。
## ④抠图结果展示与保存：
为了方便直观地观察算法处理结果，我们将分水岭算法处理得到的区域用随机颜色标记出来并向用户展示。对于最终分割结果，使用findcounars函数，将分出来的识别图像贮存在数组中，方便随时调整抠图的效果以及大批量的选择性保存抠图结果。
## ⑤通过路径选择图片：
在GUI界面上，用户对于处理图像的选取是通过选择路径的方式，采取这种操作的目的是避免反复地对程序内容进行修改，提高了灵活性。


# 三、原理介绍
分水岭分割方法以三位方式来形象化一幅图像，是一种基于拓扑理论的数学形态学的分割方法，其基本思想是把图像看作是测地学上的拓扑地貌，图像中每一点像素的灰度值表示该点的海拔高度，每一个局部极小值及其影响区域称为集水盆，而集水盆的边界则形成分水岭。分水岭的概念和形成可以通过模拟浸入过程来说明：在每一个局部极小值表面，刺穿一个小孔，然后把整个模型慢慢浸入水中，随着浸入的加深，每一个局部极小值的影响域慢慢向外扩展，在两个集水盆汇合处构筑大坝，即形成分水岭，每一个孤立的积水盆地对应一个分割区域。如图6-1所示。

![在这里插入图片描述](https://img-blog.csdnimg.cn/bbb41a36bf074706b52b8277ddcce070.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5ZCR5pel6JG16aqR5aOrRmFyYWRheQ==,size_14,color_FFFFFF,t_70,g_se,x_16)

 在真实图像中，由于噪声或其它干扰的存在，传统基于梯度的分水岭算法会由于局部最小值过多而产生过度分割的现象，这样分割出来的图像毫无用处。

而基于标记的分水岭算法可以很好地解决这个问题，标记的每个点相当于分水岭中的注水点，水淹过程从预先定义好的标记图像（像素）开始，较好的克服了过度分割的不足。本质上讲，基于标记点的改进算法是利用先验知识来帮助分割的一种方法。因此，改进算法的关键在于如何获得准确的标记图像，即如何将前景物体与背景准确的标记出来。通过先验知识，来指导分水岭算法，以便获得更好的图像分段效果。
 
 除此以外，利用前置信息进行图像分割的思路，能够很大程度上扩展程序的功能。诸如撤销操作，橡皮擦操作，选择性保存和遮挡操作等等。
# 三、使用效果
![在这里插入图片描述](https://img-blog.csdnimg.cn/317ac4ca8f534256bc03ddffa1c68104.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5ZCR5pel6JG16aqR5aOrRmFyYWRheQ==,size_12,color_FFFFFF,t_70,g_se,x_16)

可以看到 抠图的逻辑是和photoshop 不太一样的 ，但是分割抠图的目的总归是达到了。

可以任意的抠出自己想要的部位 。只需要在目标区域画上一点即可。如果分割出来的部分超出了理想区域呢？那就在目标区域外面再画一点就可以啦！

关于它的用法 真的不想讲太多 ，你亲自运行起来试试看 一定会让你经验的。 放心吧。 


源代码下载地址在我的github仓库 ， 觉得不错的画 一定要留下点赞和 github 收藏哦！谢谢你的宝贵意见 。下期再会。 

github 仓库链接🔗 ：[https://github.com/Huang-Yujiong/opencv-photoshop](https://github.com/Huang-Yujiong/opencv-photoshop)

---
# 总结
<font color=#999AAA >提示：这里对文章进行总结：
例如：以上就是今天要讲的内容，本文仅仅简单介绍了pandas的使用，而pandas提供了大量能使我们快速便捷地处理数据的函数和方法。
